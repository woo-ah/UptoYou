<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>퀴즈 게임</title>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <link rel="stylesheet" href="../../static/css/styles.css">
</head>
<body>

<div id="gquiz-top-bar">
    <div id="stage">stage3</div>
    <div id="score">정답을 맞추세요!</div>
</div>

<div>
    <div>Q<font class="font_gquiz_level">-</font>. <font class="font_gquiz_title">-</font></div>
    <input type="hidden" id="input_gquiz_answer"/>
    <input type="hidden" id="input_gquiz_point" value="0"/>
    <div class="font_gquiz_option">
    </div>

    <div style="display:none;">
        <!--첫번째 문제 - 기본환경문제-->
        <input id="input_q11" class="input_qgroup1" value="지구의 평균 온도를 상승시키는 주요 원인은 무엇인가요?" keyword="2" />
        <input id="input_q11_option1" class="input_q11_option" value="산소 부족" />
        <input id="input_q11_option2" class="input_q11_option" value="온실가스 증가" />
        <input id="input_q11_option3" class="input_q11_option" value="오존층 감소" />
        <input id="input_q11_option4" class="input_q11_option" value="대기 중 먼지 감소" />

        <input id="input_q12" class="input_qgroup1" value="바다를 오염시키는 주된 플라스틱 쓰레기는 무엇인가요?" keyword="1" />
        <input id="input_q12_option1" class="input_q12_option" value="비닐봉지" />
        <input id="input_q12_option2" class="input_q12_option" value="페트병" />
        <input id="input_q12_option3" class="input_q12_option" value="빨대" />
        <input id="input_q12_option4" class="input_q12_option" value="플라스틱 병뚜껑" />

        <input id="input_q13" class="input_qgroup1" value="다음 중 온실가스를 가장 많이 배출하는 활동은 무엇인가요?" keyword="2" />
        <input id="input_q13_option1" class="input_q13_option" value="전기차 충전" />
        <input id="input_q13_option2" class="input_q13_option" value="화석연료 발전" />
        <input id="input_q13_option3" class="input_q13_option" value="재활용 플라스틱 제조" />
        <input id="input_q13_option4" class="input_q13_option" value="태양광 발전" />

        <input id="input_q14" class="input_qgroup1" value="지구 온난화의 주된 영향으로 옳지 않은 것은?" keyword="3" />
        <input id="input_q14_option1" class="input_q14_option" value="해수면 상승" />
        <input id="input_q14_option2" class="input_q14_option" value="극지방 빙하 감소" />
        <input id="input_q14_option3" class="input_q14_option" value="산림 면적 증가" />
        <input id="input_q14_option4" class="input_q14_option" value="이상 기후 발생" />

        <input id="input_q15" class="input_qgroup1" value="온실가스 중 가장 큰 비중을 차지하는 것은 메탄가스입니다." keyword="X" />
        <input id="input_q15_option1" class="input_q15_option" value="O" />
        <input id="input_q15_option2" class="input_q15_option" value="X" />

        <input id="input_q16" class="input_qgroup1" value="지구 온난화는 빙하가 녹아 해수면을 상승시킵니다." keyword="O" />
        <input id="input_q16_option1" class="input_q16_option" value="O" />
        <input id="input_q16_option2" class="input_q16_option" value="X" />


        <!--두번째 문제 - 재활용 -->
        <input id="input_q21" class="input_qgroup2" value="스티로폼은 깨끗하면 재활용이 가능합니다." keyword="1" />
        <input id="input_q21_option1" class="input_q21_option" value="O" />
        <input id="input_q21_option2" class="input_q21_option" value="X" />

        <input id="input_q22" class="input_qgroup2" value="다음 중 재활용할 수 없는 것은 무엇인가요?" keyword="2" />
        <input id="input_q22_option1" class="input_q22_option" value="깨끗한 종이컵" />
        <input id="input_q22_option2" class="input_q22_option" value="오염된 피자 박스" />
        <input id="input_q22_option3" class="input_q22_option" value="플라스틱 병뚜껑" />
        <input id="input_q22_option4" class="input_q22_option" value="알루미늄 캔" />

        <input id="input_q23" class="input_qgroup2" value="플라스틱을 재활용할 때 분리배출이 어려운 경우는?" keyword="3" />
        <input id="input_q23_option1" class="input_q23_option" value="투명한 페트병" />
        <input id="input_q23_option2" class="input_q23_option" value="스티로폼" />
        <input id="input_q23_option3" class="input_q23_option" value="이물질이 묻은 플라스틱" />
        <input id="input_q23_option4" class="input_q23_option" value="투명 필름" />

        <input id="input_q24" class="input_qgroup2" value="다음 중 올바른 분리배출 방법은 무엇인가요?" keyword="1" />
        <input id="input_q24_option1" class="input_q24_option" value="기름 묻은 종이컵은 일반 쓰레기로 배출한다." />
        <input id="input_q24_option2" class="input_q24_option" value="플라스틱 병은 라벨을 제거하지 않고 배출한다." />
        <input id="input_q24_option3" class="input_q24_option" value="유리병은 내용물을 제거하지 않아도 된다." />
        <input id="input_q24_option4" class="input_q24_option" value="종이상자는 테이프를 붙인 채 배출한다." />

        <input id="input_q25" class="input_qgroup2" value="종이 재활용을 위해 피해야 할 행동은 무엇인가요?" keyword="3" />
        <input id="input_q25_option1" class="input_q25_option" value="깨끗한 종이만 분리배출한다." />
        <input id="input_q25_option2" class="input_q25_option" value="이물질이 묻은 종이는 일반 쓰레기로 배출한다." />
        <input id="input_q25_option3" class="input_q25_option" value="신문지는 다른 재활용품과 함께 배출한다." />
        <input id="input_q25_option4" class="input_q25_option" value="스티커가 붙은 종이는 떼어낸 후 배출한다." />

        <input id="input_q26" class="input_qgroup2" value="플라스틱 병뚜껑은 병과 분리해서 재활용해야 합니다." keyword="1" />
        <input id="input_q26_option1" class="input_q26_option" value="O" />
        <input id="input_q26_option2" class="input_q26_option" value="X" />


        <!--세번째 문제-->
        <input id="input_q31" class="input_qgroup3" value="물 사용량을 줄이기 위해 세탁기를 적은 양으로 여러 번 돌리는 것이 효율적입니다." keyword="2" />
        <input id="input_q31_option1" class="input_q31_option" value="O" />
        <input id="input_q31_option2" class="input_q31_option" value="X" />

        <input id="input_q32" class="input_qgroup3" value="전등을 LED로 교체하면 기존 전구 대비 얼마나 에너지를 절약할 수 있나요?" keyword="3" />
        <input id="input_q32_option1" class="input_q32_option" value="약 10%" />
        <input id="input_q32_option2" class="input_q32_option" value="약 50%" />
        <input id="input_q32_option3" class="input_q32_option" value="약 75%" />
        <input id="input_q32_option4" class="input_q32_option" value="약 90%" />

        <input id="input_q33" class="input_qgroup3" value="한 사람이 하루에 사용하는 물의 양은 평균 몇 리터일까요?" keyword="3" />
        <input id="input_q33_option1" class="input_q33_option" value="약 50리터" />
        <input id="input_q33_option2" class="input_q33_option" value="약 100리터" />
        <input id="input_q33_option3" class="input_q33_option" value="약 300리터" />
        <input id="input_q33_option4" class="input_q33_option" value="약 500리터" />

        <input id="input_q34" class="input_qgroup3" value="전자제품을 대기전력 상태로 두었을 때, 평균 전력 소비량은 어느 정도일까요?" keyword="2" />
        <input id="input_q34_option1" class="input_q34_option" value="전력의 약 1%" />
        <input id="input_q34_option2" class="input_q34_option" value="전력의 약 5%" />
        <input id="input_q34_option3" class="input_q34_option" value="전력의 약 10%" />
        <input id="input_q34_option4" class="input_q34_option" value="전력의 약 20%" />

        <input id="input_q35" class="input_qgroup3" value="물을 절약하기 위한 가장 효과적인 방법은 무엇인가요?" keyword="1" />
        <input id="input_q35_option1" class="input_q35_option" value="샤워 시간을 줄인다." />
        <input id="input_q35_option2" class="input_q35_option" value="식기세척기를 자주 사용한다." />
        <input id="input_q35_option3" class="input_q35_option" value="세탁물을 적은 양씩 나누어 세탁한다." />
        <input id="input_q35_option4" class="input_q35_option" value="흐르는 물로 야채를 세척한다." />

        <input id="input_q36" class="input_qgroup3" value="가전제품을 사용하지 않을 때 전원을 끄면 대기전력이 완전히 사라집니다." keyword="2" />
        <input id="input_q36_option1" class="input_q36_option" value="O" />
        <input id="input_q36_option2" class="input_q36_option" value="X" />


        <!--네번째 문제-->
        <input id="input_q41" class="input_qgroup4" value="다음 중 멸종위기종에 해당하는 동물은 무엇인가요?" keyword="1" />
        <input id="input_q41_option1" class="input_q41_option" value="판다" />
        <input id="input_q41_option2" class="input_q41_option" value="갈매기" />
        <input id="input_q41_option3" class="input_q41_option" value="다람쥐" />
        <input id="input_q41_option4" class="input_q41_option" value="까마귀" />

        <input id="input_q42" class="input_qgroup4" value="산림이 흡수하는 이산화탄소 양은 전체의 몇 퍼센트일까요?" keyword="2" />
        <input id="input_q42_option1" class="input_q42_option" value="약 10%" />
        <input id="input_q42_option2" class="input_q42_option" value="약 25%" />
        <input id="input_q42_option3" class="input_q42_option" value="약 50%" />
        <input id="input_q42_option4" class="input_q42_option" value="약 75%" />

        <input id="input_q43" class="input_qgroup4" value="다음 중 산림 파괴로 인해 가장 큰 영향을 받는 것은?" keyword="1" />
        <input id="input_q43_option1" class="input_q43_option" value="토양 침식" />
        <input id="input_q43_option2" class="input_q43_option" value="해양 생태계" />
        <input id="input_q43_option3" class="input_q43_option" value="지하수 오염" />
        <input id="input_q43_option4" class="input_q43_option" value="대기 중 산소 농도 감소" />

        <input id="input_q44" class="input_qgroup4" value="생태계 복원을 위한 가장 효과적인 방법은 무엇인가요?" keyword="2" />
        <input id="input_q44_option1" class="input_q44_option" value="인공 식물 배치" />
        <input id="input_q44_option2" class="input_q44_option" value="야생 동물 보호 구역 확대" />
        <input id="input_q44_option3" class="input_q44_option" value="도시 건축물에 녹색 벽 설치" />
        <input id="input_q44_option4" class="input_q44_option" value="외래종 식물 심기" />

        <input id="input_q45" class="input_qgroup4" value="열대우림은 전 세계 산소의 50%를 생산합니다." keyword="2" />
        <input id="input_q45_option1" class="input_q45_option" value="O" />
        <input id="input_q45_option2" class="input_q45_option" value="X" />

        <input id="input_q46" class="input_qgroup4" value="멸종위기종을 보호하기 위해 서식지를 지키는 것이 가장 중요합니다." keyword="1" />
        <input id="input_q46_option1" class="input_q46_option" value="O" />
        <input id="input_q46_option2" class="input_q46_option" value="X" />


        <!--다섯번째 문제-->
        <input id="input_q51" class="input_qgroup5" value="탄소 배출을 줄이기 위해 권장되는 생활 습관이 아닌 것은?" keyword="3" />
        <input id="input_q51_option1" class="input_q51_option" value="대중교통 이용" />
        <input id="input_q51_option2" class="input_q51_option" value="육류 소비 줄이기" />
        <input id="input_q51_option3" class="input_q51_option" value="에어컨 온도 낮추기" />
        <input id="input_q51_option4" class="input_q51_option" value="재사용 가능한 물병 사용" />

        <input id="input_q52" class="input_qgroup5" value="다음 중 탄소 중립을 가장 잘 설명하는 것은?" keyword="2" />
        <input id="input_q52_option1" class="input_q52_option" value="이산화탄소 배출을 전혀 하지 않는 상태" />
        <input id="input_q52_option2" class="input_q52_option" value="배출한 만큼의 이산화탄소를 제거하여 균형을 맞추는 상태" />
        <input id="input_q52_option3" class="input_q52_option" value="화석연료 사용을 완전히 중단한 상태" />
        <input id="input_q52_option4" class="input_q52_option" value="에너지를 전혀 사용하지 않는 상태" />

        <input id="input_q53" class="input_qgroup5" value="기후 변화로 인해 다음 중 가장 큰 영향을 받는 것은 무엇인가요?" keyword="1" />
        <input id="input_q53_option1" class="input_q53_option" value="극지방의 동물" />
        <input id="input_q53_option2" class="input_q53_option" value="사막 생태계" />
        <input id="input_q53_option3" class="input_q53_option" value="해저 생태계" />
        <input id="input_q53_option4" class="input_q53_option" value="열대우림의 곤충" />

        <input id="input_q54" class="input_qgroup5" value="탄소 배출을 줄이는 데 가장 효과적인 에너지원은 무엇인가요?" keyword="3" />
        <input id="input_q54_option1" class="input_q54_option" value="석탄" />
        <input id="input_q54_option2" class="input_q54_option" value="원자력" />
        <input id="input_q54_option3" class="input_q54_option" value="태양광" />
        <input id="input_q54_option4" class="input_q54_option" value="천연가스" />

        <input id="input_q55" class="input_qgroup5" value="육류 생산은 온실가스를 많이 배출하는 산업 중 하나입니다." keyword="1" />
        <input id="input_q55_option1" class="input_q55_option" value="O" />
        <input id="input_q55_option2" class="input_q55_option" value="X" />

        <input id="input_q56" class="input_qgroup5" value="태양광 에너지는 탄소 배출이 전혀 없습니다." keyword="2" />
        <input id="input_q56_option1" class="input_q56_option" value="O" />
        <input id="input_q56_option2" class="input_q56_option" value="X" />


        
    </div>

    <div id="describe">
        부정한 방법으로 게임에 참여하는 경우,<br> 참여가 중단되거나 리워드가 회수될 수 있습니다.</div>
</div>

<!-- 모달 창 -->
<div id="modal" style="display: none;">
    <div id="modal-content">
        <h2>시간 멈추기 성공!</h2>
        <p>게임을 클리어 하였어요!</p>
    </div>
</div>




<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    let clock = 0;
    let gameActive = false;
    let totalGameTime = 10000; // 게임 시간 10초
    let progressInterval = null;

    const userId = localStorage.getItem("reqUserId");
    $("#detail_username").text(localStorage.getItem("reqUserUsername"));
</script>
<script>
    var font_gquiz_level = 1;
    $( document ).ready(function() {
        listenerQuestion();
    });

    function listenerQuestion(){
        let input_qgroup = $(".input_qgroup" + font_gquiz_level);
        // Returns a random integer from 0 to num-1:
        let order = Math.floor(Math.random() * input_qgroup.length);
        let tId = $(input_qgroup[order]).attr("id");
        let tQuestion = $("#" + tId).val();
        let tAnswer = Number($("#" + tId).attr("keyword")) - 1;

        $(".font_gquiz_level").text(font_gquiz_level);
        $(".font_gquiz_title").text(tQuestion);
        $("#input_gquiz_answer").val(tAnswer);

        $(".font_gquiz_option").html("");
        let input_q_option = $("." + tId + "_option");
        for(let i=0; i<input_q_option.length; i++){
            $(".font_gquiz_option").append("<div onclick='listenerAnswer("+i+")'>"+$(input_q_option[i]).val()+"</div>");
        }
    }
    function listenerAnswer(obj_val){
        let tAnswer = Number($("#input_gquiz_answer").val());
        if(obj_val === tAnswer){
            let input_gquiz_point = Number($("#input_gquiz_point").val());
            $("#input_gquiz_point").val(++input_gquiz_point);
            alert("정답입니다!");
        } else {
            alert("오답입니다...");
        }

        if(font_gquiz_level < 3){
            font_gquiz_level++;
            listenerQuestion();
        } else {

            // 모달 표시
            const modal = document.getElementById('modal');
            modal.style.display = 'flex';

            let point = 20 - Number($("#input_gquiz_point").val());
            //alert(point);
            $.ajax({
                url: "/api/gquiz",
                type: "POST",
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify({
                    userId: userId,
                    point: point
                }),
                cache: false,
                success: (obj_data, status, xhr) => {
                    console.log("AJAX Success:", obj_data);
                    alert("성공적으로 저장되었습니다!");

                    const modal = document.getElementById('modal');
                    modal.style.display = 'flex';

                    // 2초 후 모달 닫기 및 페이지 이동
                    modalTimer = setTimeout(() => {
                        modal.style.display = 'none';
                        location.replace("/gquiz/award");
                    }, 2000);
                },
                error: (xhr, status, error) => {
                    console.error("AJAX Error:", xhr.responseText);
                    alert("서버 저장 중 오류가 발생했습니다.");
                }
            });

        }
    }
</script>
</body>
</html>
